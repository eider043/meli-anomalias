<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36" version="29.3.6">
  <diagram id="diagram1" name="Ejercicio 1 - Arquitectura">
    <mxGraphModel dx="1246" dy="1564" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="A" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;shape=mxgraph.flowchart.data;fillColor=#dae8fc;" value="precios_historicos.csv" vertex="1">
          <mxGeometry height="60" width="220" x="50" y="-92" as="geometry" />
        </mxCell>
        <mxCell id="B" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;fillColor=#d5e8d4;" value="Carga + parse fechas&#xa;Orden temporal por ITEM_ID" vertex="1">
          <mxGeometry height="70" width="280" x="320" y="-97" as="geometry" />
        </mxCell>
        <mxCell id="C" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;fillColor=#d5e8d4;" value="Ventanas (rolling) solo pasado&#xa;shift(1) + rolling" vertex="1">
          <mxGeometry height="70" width="280" x="640" y="-97" as="geometry" />
        </mxCell>
        <mxCell id="GT" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;fillColor=#d5e8d4;" value="Ground Truth proxy&#xa;rolling MAD z-score&#xa;(GT_ROLL_WINDOW, GT_THRESHOLD_Z)" vertex="1">
          <mxGeometry height="90" width="290" x="980" y="-107" as="geometry" />
        </mxCell>
        <mxCell id="STAT" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;fillColor=#d5e8d4;" value="Modelo estadístico (baseline)&#xa;rolling MAD z-score&#xa;(ROLL_WINDOW, ANOMALY_THRESHOLD_Z)" vertex="1">
          <mxGeometry height="90" width="290" x="635" y="70" as="geometry" />
        </mxCell>
        <mxCell id="H2H" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;shape=mxgraph.flowchart.decision;fillColor=#fff2cc;" value="Modo A: Head-to-Head subset&#xa;Estratificado (positivos/negativos)&#xa;H2H_N_TOTAL, H2H_POS_FRAC" vertex="1">
          <mxGeometry height="90" width="320" x="240" y="225" as="geometry" />
        </mxCell>
        <mxCell id="LLM1" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;fillColor=#d5e8d4;" value="LLM eval (API)&#xa;llm_predict en TODAS&#xa;las filas del subset" vertex="1">
          <mxGeometry height="70" width="280" x="620" y="235" as="geometry" />
        </mxCell>
        <mxCell id="PRE" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;shape=mxgraph.flowchart.decision;fillColor=#fff2cc;" value="Modo B: Prefiltro producción&#xa;Candidatos = label_stat==ANOMALO&#xa;Cap MAX_LLM_CALLS_PROD" vertex="1">
          <mxGeometry height="90" width="320" x="10" y="340" as="geometry" />
        </mxCell>
        <mxCell id="LLM2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;fillColor=#d5e8d4;" value="LLM producción (API)&#xa;llm_predict SOLO en&#xa;candidatos (stat)" vertex="1">
          <mxGeometry height="70" width="280" x="400" y="350" as="geometry" />
        </mxCell>
        <mxCell id="OUT1" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;shape=mxgraph.flowchart.document;fillColor=#f8cecc;" value="outputs/predictions_h2h.csv" vertex="1">
          <mxGeometry height="60" width="290" x="1300" y="315" as="geometry" />
        </mxCell>
        <mxCell id="OUT2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;shape=mxgraph.flowchart.document;fillColor=#f8cecc;" value="outputs/predictions_prefilter.csv" vertex="1">
          <mxGeometry height="60" width="290" x="395" y="490" as="geometry" />
        </mxCell>
        <mxCell id="EVAL" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;fillColor=#d5e8d4;" value="Evaluación&#xa;F1/Precision/Recall&#xa;+ Bootstrap ΔF1 (A vs B)" vertex="1">
          <mxGeometry height="90" width="290" x="1300" y="475" as="geometry" />
        </mxCell>
        <mxCell id="PLOTS" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;fillColor=#d5e8d4;" value="Plots por producto&#xa;STAT vs LLM + bandas&#xa;(stat_lower/stat_upper)" vertex="1">
          <mxGeometry height="80" width="280" x="600" y="625" as="geometry" />
        </mxCell>
        <mxCell id="METRICS" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000;shape=mxgraph.flowchart.document;fillColor=#f8cecc;" value="outputs/metrics_table_*.csv&#xa;outputs/bootstrap_*.json" vertex="1">
          <mxGeometry height="70" width="290" x="980" y="630" as="geometry" />
        </mxCell>
        <mxCell id="NOTE" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#999999;dashed=1;" value="Nota:&#xa;Producción: usar prefiltro&#xa;por costo/latencia.&#xa;Head-to-head: comparación justa." vertex="1">
          <mxGeometry height="110" width="220" x="60" y="520" as="geometry" />
        </mxCell>
        <mxCell id="e1" edge="1" parent="1" source="A" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="B" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e2" edge="1" parent="1" source="B" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="C" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e3" edge="1" parent="1" source="C" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="GT" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e4" edge="1" parent="1" source="C" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="STAT" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e5" edge="1" parent="1" source="STAT" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="H2H" value="subset">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e6" edge="1" parent="1" source="H2H" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="LLM1" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e7" edge="1" parent="1" source="LLM1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="OUT1" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e8" edge="1" parent="1" source="STAT" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="PRE" value="candidatos">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e9" edge="1" parent="1" source="PRE" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="LLM2" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e10" edge="1" parent="1" source="LLM2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="OUT2" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e11" edge="1" parent="1" source="OUT1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="EVAL" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e12" edge="1" parent="1" source="OUT2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="EVAL" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e13" edge="1" parent="1" source="EVAL" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="METRICS" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e14" edge="1" parent="1" source="OUT1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="PLOTS" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e15" edge="1" parent="1" source="OUT2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="PLOTS" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e16" edge="1" parent="1" source="PLOTS" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=block;endFill=1;" target="METRICS" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
